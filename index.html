var R=255,G=0,B=0;
var start=0,stop=0;
var id=0;
var val=5;
$(document).ready(function(){
    var burgerchk=0;
    $('#menu_control').click(function(){
        if(burgerchk){
            burgerchk=0;
            $('.content1-button').css("left","50%");
        }else{
            burgerchk=1;
            $('.content1-button').css("left","-100%");
        }
    });
});

/*Ê†πÊìötimeË®≠ÂÆö*/
id = setInterval(function() {
    changRGB();
},val);
// console.log(id);
/*ÈÄüÂ∫¶*/
$(document).ready(function(){
    $('#slider').slider({
        min: 0,
        max: 100,
        step: 0.1,
        value: 50,
        slide: function(e, ui) {
            clearInterval(id);
            val=Math.round(ui.value/10);
            console.log(val);
            id = setInterval(function(){
                changRGB();
            },val);
        },
    });
});

/*RGBÊ®°ÂºèÈñãÈóú*/
$(document).ready(function(){
    $('.crazybox').click(function(){
        if(start==0){
            start=1;
            R=255,G=0,B=0;
            /*RGBÊ®°ÂºèÊâìÈñã*/
            $('.crazy p').css('color','#000');
            $('.menu a').css('color','#000');
            $('.crazyplay-content p').css('color','#000');
            $('.crazyplay-icon p').css('color','#000');
            $('.speed p').css('color','#000');
            $('.crazyplay-icon p').css('cursor','pointer');
            $('.crazyplay-icon p').text('||');
            $('.crazyplay-content p').text('Êö´ÂÅú');
            $('.crazyplay-icon p').css( 'padding-left','1px');
            $('.crazyplay').css('opacity','100%');
        }else{
            /*RGBÊ®°ÂºèÈóúÈñâ*/
            start=0;
            $('.crazy p').css('color','#fff');
            $('.menu a').css('color','#fff');
            $('.crazyplay-content p').css('color','#fff');
            $('.crazyplay-icon p').css('color','#fff');
            $('.crazyplay-icon p').css('cursor','default');
            $('.speed p').css('color','#fff');
            $('.crazyplay-icon p').text('‚ñ∂')
            $('.crazyplay-content p').text('Êí≠Êîæ')
            $('.crazyplay').css('opacity','25%');
        }
    });
    $('.crazyplay-icon').click(function(){
        if(start==1){
            /*Êö´ÂÅú*/
            if(stop==0){
                stop=1;
                $('.crazyplay-icon p').text('‚ñ∂')
                $('.crazyplay-content p').text('Êí≠Êîæ')
                $('.crazyplay-icon p').css( 'padding-left','3px')
            }else{
                /*ÈñãÂßã*/
                stop=0;
                $('.crazyplay-icon p').text('||')
                $('.crazyplay-icon p').css( 'padding-left','1px')
                $('.crazyplay-content p').text('Êö´ÂÅú')
            }
        }
    });
});

/*ÊîπËÆäRGBÊï∏ÂÄº*/
function changRGB () {
    if(start==1){
        if(stop==1){
            $('.header').css('background-color' ,'rgb('+R+','+G+','+B+')');
        }
        else if(R==255 && G!=255 && B==0){
            G++;
        }else if(R!=0 && G==255 && B==0){
            R--;
        }else if(R==0 && G==255 && B!=255){
            B++;
        }else if(R==0 && G!=0 && B==255){
            G--;
        }else if(R!=255 && G==0 && B==255){
            R++;
        }else if(R==255 && G==0 && B!=0){
            B--;
        }
        changColor();
    }else if(start==0){
        $('.header').css('background-color' ,'#444');
    }
}

/*Êõ¥ÊèõËÉåÊôØRGBÂáΩÂºè*/
function changColor(){
    $(document).ready(function(){
        $('.header').css('background-color' ,'rgb('+R+','+G+','+B+')');
        
        // $('.header').css('background' ,'linear-gradient(360deg,#bbb,'+'rgb('+R+','+G+','+B+')');
        $('.OK').text(R+','+G+','+B);
    });
}

var open=0;
$(document).ready(function(){
    today = Date();
    $('.nowtime').html('<h1>'+today+'</h1>');
    console.log("ÊôÇÈñìËºâÂÖ•Ê≠£Â∏∏"+today);
});

var startt=0,diss=0,contin=0,rank1=0,rank2=0,rank3=0,startck=0,realck=0;
$(document).ready(function(){
    function time(){
        var t = null;
        var d = new Date();
        var year = d.getFullYear();
        var month = d.getMonth() + 1;
        var day = d.getDate();
        var hour = d.getHours();
        var minute = d.getMinutes();
        var sec = d.getSeconds();
        var string="<h1>ÁõÆÂâçÊôÇÈñìÔºö" + year + "Âπ¥";
        if(month<10) string += "0" + month + "Êúà";
        else string += month + "Êúà";
        if(day<10) string += "0" + day + "Êó•";
        else string += day + "Êó•";
        if(hour>12){
            if((hour-12)>10)string+= "‰∏ãÂçà" + (hour-12) +"ÊôÇ";
            else string+= "‰∏ãÂçà0" + (hour-12) +"ÊôÇ"
        }
        else{
            if((hour)>=10)string+= "‰∏ãÂçà" + hour +"ÊôÇ";
            else string+= "‰∏ãÂçà0" + hour-12 +"ÊôÇ"
        }
        if(minute<10)string += "0" + minute + "ÂàÜ";
        else string += minute + "ÂàÜ";
        if(sec<10)string += "0" + sec + "Áßí";
        else string += sec + "Áßí";
        $('.nowtime').html(string + '</h1>');
        $('.block_yearOK').css('width',(year-2000)/1000*100+"%");
        $('.block_year_circle').css('left','calc(' + ((year-2000)/1000*100) + '%' + ' - 10px)')
        $('.block_monthOK').css('width',month/12*100+"%");
        $('.block_month_circle').css('left','calc(' + (month/12*100) + '%' + ' - 10px)')
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12){
            $('.block_dayOK').css('width',day/31*100+"%");
            $('.block_day_circle').css('left','calc(' + (day/31*100) + '%' + ' - 10px)');
        }
        else if(month==2){
            if((year%4==0&&year%100!=0)||year%400==0){
                $('.block_dayOK').css('width',day/29*100+"%");
                $('.block_day_circle').css('left','calc(' + (day/29*100) + '%' + ' - 10px)');
            }
            else {
                $('.block_dayOK').css('width',day/28*100+"%");
                $('.block_day_circle').css('left','calc(' + (day/28*100) + '%' + ' - 10px)');
            }
        }
        else {
            $('.block_dayOK').css('width',day/30*100+"%");
            $('.block_day_circle').css('left','calc(' + (day/30*100) + '%' + ' - 10px)');
        }
        $('.block_dayOK').css('width',day/31*100+"%");
        if(hour>12){
            $('.block_hourOK').css('width',(hour-12)/12*100+"%");
            $('.block_hour_circle').css('left','calc(' + ((hour-12)/12*100) + '%' + ' - 10px)');
        }
        else{
            if(hour>10){
                $('.block_hourOK').css('width',hour/12*100+"%");
                $('.block_hour_circle').css('left','calc(' + (hour/12*100) + '%' + ' - 10px)');
            }
            else{
                $('.block_hourOK').css('width',hour/12*100+"%");
                $('.block_hour_circle').css('left','calc(' + (hour/12*100) + '%' + ' - 10px)');
            }
        }
        $('.block_minuteOK').css('width',minute/60*100+"%");
        $('.block_minute_circle').css('left','calc(' + (minute/60*100) + '%' + ' - 10px)');
        $('.block_secOK').css('width',sec/60*100+"%");
        $('.block_sec_circle').css('left','calc(' + (sec/60*100) + '%' + ' - 10px)');
        if(contin==1){
            diss++;
            $('.startnum').html("Ââ©È§ò" + Math.round(30-(diss+1)/2) + "s");
            if(diss>=60){
                contin=0;
                diss=0;
                if(rank1<realck){
                    temp=rank1;
                    rank1=realck;
                    realck=temp;
                }
                if(rank2<realck){
                    temp=rank2;
                    rank2=realck;
                    realck=temp;
                }
                if(rank3<realck){
                    temp=rank3;
                    rank3=realck;
                    realck=temp;
                }
                $('.rank1').html("ü•áFirst : " + rank1 +" ‰∏ã")
                $('.rank2').html("ü•àSecond: " + rank2 +" ‰∏ã")
                $('.rank3').html("ü•âThird : " + rank3 +" ‰∏ã")
            }
        }
        t = setTimeout (time,500);
        }
    time();
    $('.startbtn').click(function(){
        realck=0;
        contin = 1;
        diss=0;
        startck=0;
        console.log("TOUCH");
    });
    var t;
    $('.cont3img').click(function(){
        if(contin==1){
            realck++;
        }
        startck++;
        clearTimeout(t);
        $('.cont3img').html('<img src="OMG2.png" width="444" height="790">');
        const audio = document.createElement("audio");
        audio.src = "music.mp3";
        audio.play();
        $('.content3').css('cursor','grabbing')
        $('.cont3txt').html("<h1>"+startck+"</h1>");
        $('.cont3txt').css('transform','rotate(10deg)');
        t=setTimeout(function(){
            $('.content3').css('cursor','grab')
            $('.cont3img').html('<img src="OMG1.png" width="444" height="790">');
            $('.cont3txt').css('transform','rotate(0deg)');
        },125);
    });
});

$(document).ready(function(){
    $('.content1-button').click(function(){
        if(open==0){
            open=1;
            $('.time').css("opacity" ,"100%");
            $('.time').css("top" ,"330px");
        }else{
            open=0;
            $('.time').css("opacity" ,"0%");
            $('.time').css("top" ,"-350px");

        }
    });
    $('.timeopen').click(function(){
        if(open==0){
            open=1;
            $('.time').css("opacity" ,"100%");
            $('.time').css("top" ,"330px");
            loadWeather("taiwan");
        }else{
            open=0;
            $('.time').css("opacity" ,"0%");
            $('.time').css("top" ,"-350px");
        }
    });
    $('.closebtn').click(function(){
        open=0;
        $('.time').css("opacity" ,"0%");
        $('.time').css("top" ,"-350px");
    });
});

function loadWeather(cityCoords){
    var latlng =25.0336 + "," +  121.5644;
    var forecastURL = "https://api.forecast.io/forecast/982ecb3e65ae65c6d9db9ce3dea7c90c/"+latlng;
    //ÂÇôÁî®Ôºö https://api.forecast.io/forecast/52cec5ff313a4d19b60540cfe89675a5
    console.log(forecastURL);
    $.ajax({
        url: forecastURL,
        jsonpCallback: 'jsonCallback',
        contentType: "application/json",
        dataType: 'jsonp',
        /* ÊàêÂäü */
        success: function(json){
            console.log(json);
            $('.K101temp').html("<h3>Ê∫´Â∫¶Ôºö" + ((json.currently.temperature-32)*(5/9)).toFixed(2)+"&#176;C / " + json.currently.temperature + "&#176;F</h3>");
            $('.K101wet').html("<h3>ÊøïÂ∫¶Ôºö" + json.currently.humidity + "</h3>");
            $(".K101des").html("<h3>Â§©Ê∞£ÁãÄÊÖãÔºö" + json.currently.icon + "</h3>");
        },
        /* ÈåØË™§ */
        error: function(e){
            console.log(e.message);
        }
    });
}
$(document).ready(function(){
    $('.content1-button').click(function(){
        loadWeather("taiwan");
    });
});


var lastclick,movein=0;
$(document).ready(function(){
    $('.TaiwanIMG div').mouseover(function(){
        movein=1;
        if(lastclick!=('.' + this.className)){
            $(this).css('background-color', 'rgb(255, 251, 0)');
            $(this).css('transform', 'scale(1.6)');
        }
    })
    $('.TaiwanIMG div').mouseout(function(){
        if(movein!=2 && lastclick!=('.'+this.className)){
            $(this).css('background-color', 'rgba(255, 255, 255, 0.8)');
            $(this).css('transform', 'scale(1)');
        }
        movein=0;
    })
    $('.TaiwanIMG div').click(function(){
        movein=2;
        $('.CSweather').css('background-color','#505050');
        $(lastclick).css('transform', 'scale(1)');
        $(lastclick).css('background-color', 'rgba(255, 255, 255, 0.8)');
        $(this).css('background-color','rgb(255, 187, 0)');
        $(this).css('transform', 'scale(1.6)');
        lastclick='.' + this.className;
    });

function loadWeather(citycode){
    let api_key = 'CWB-C96B02A5-E839-4870-B96E-B529AFC22581'
    let forecastURL = `https://opendata.cwb.gov.tw/fileapi/v1/opendataapi/`+citycode+`?Authorization=${api_key}&format=JSON` 
    console.log(forecastURL);
    $(document).ready(function(){
    $('.div').html("ËºâÂÖ•‰∏≠");
    $.ajax({
    url: forecastURL,
    type: "get",
    dataType:"json",
    success: function (info) {
        console.log(info);
        var abc="",num;
        for(i=0;i<40;i++){
            $('.div'+i).html("");
            $('.div'+i).css('border','none');
        }
        if(info.cwbopendata.dataset.locations.location.length%4>0){
            num=(info.cwbopendata.dataset.locations.location.length-(info.cwbopendata.dataset.locations.location.length%4))/4+1;
        }else{
            num=info.cwbopendata.dataset.locations.location.length/4;
        }
        $('.CSweather').css('height',num*194);
        if(info.cwbopendata.dataset.locations.location.length>40)alert("ERROR");
        for(i=0;i<info.cwbopendata.dataset.locations.location.length;i++){
            console.log(i);
            var temp=info.cwbopendata.dataset.locations.location[i];
            $('.div'+i).html("<h3>"+`<font color=yellow>` + temp.locationName + " " + temp.weatherElement[12].time[0].elementValue[0].value + "</font></h3>" +
                            "ÊúÄÈ´òÊ∫´Ôºö" + temp.weatherElement[3].time[0].elementValue.value+ "&#176;C" + " ÊúÄ‰ΩéÊ∫´Ôºö" + temp.weatherElement[4].time[0].elementValue.value + "&#176;C" + "<br>"+
                            "Âπ≥ÂùáÊ∫´Â∫¶Ôºö"+ (temp.weatherElement[0].time[0].elementValue.value) +"&#176;C"+ "<br>" +
                            "Âπ≥ÂùáÊøïÂ∫¶Ôºö"+ temp.weatherElement[2].time[0].elementValue.value+"%"+"<br>"+
                            `<font color=aqua>` + "ÈôçÈõ®Ê©üÁéáÔºö"+temp.weatherElement[9].time[0].elementValue.value+"%"+"</font><br>"+
                            `<font color="orange">`+ "Á¥´Â§ñÁ∑öÔºö" +temp.weatherElement[13].time[0].elementValue[0].value+ "Á¥ö  " +temp.weatherElement[13].time[0].elementValue[1].value + "Êõ¨ÂÇ∑ÊåáÊï∏</font><br>"
            );
            $('.div'+i).css('border','solid 2px black');
        }
    },
    error: function (data) {
        console.log("Ë´ãÊ±ÇÂ§±Êïó");
    }
});
});
} 
$(document).ready(function(){
    $('.Keelung').click(function(){ loadWeather("F-D0047-051");});
    $('.NewTaipei').click(function(){ loadWeather("F-D0047-071");});
    $('.Taipei').click(function(){ loadWeather("F-D0047-063");});
    $('.Taoyuan').click(function(){ loadWeather("F-D0047-007");});
    $('.HsinchuC').click(function(){ loadWeather("F-D0047-011");});
    $('.HsinchuS').click(function(){ loadWeather("F-D0047-055");});
    $('.Miaoli').click(function(){ loadWeather("F-D0047-015");});
    $('.Taichung').click(function(){ loadWeather("F-D0047-075");});
    $('.Changhua').click(function(){ loadWeather("F-D0047-019");});
    $('.Nantou').click(function(){ loadWeather("F-D0047-023");});
    $('.Yunlin').click(function(){ loadWeather("F-D0047-027");});
    $('.ChiayiC').click(function(){ loadWeather("F-D0047-031");});
    $('.ChiayiS').click(function(){ loadWeather("F-D0047-059");});
    $('.Tainan').click(function(){ loadWeather("F-D0047-079");});
    $('.Kaohsiung').click(function(){ loadWeather("F-D0047-067");});
    $('.Pingtung').click(function(){ loadWeather("F-D0047-035");});
    $('.Yilan').click(function(){ loadWeather("F-D0047-003");});
    $('.Hualien').click(function(){ loadWeather("F-D0047-043");});
    $('.Taitung').click(function(){ loadWeather("F-D0047-039");});
    $('.Penghu').click(function(){ loadWeather("F-D0047-047");});
    $('.Kinmen').click(function(){ loadWeather("F-D0047-087");});
    $('.Lienchiang').click(function(){ loadWeather("F-D0047-083");});
});
//20220609
});
$(document).ready(function(){
    $('.send').click(function(){
        var choosecity=document.getElementById("city4").value;
        var choosedist=document.getElementById("dist4").value;
        if(choosecity=='Âü∫ÈöÜÂ∏Ç')loadWeather2("F-D0047-051",choosedist);
        if(choosecity=='Êñ∞ÂåóÂ∏Ç')loadWeather2("F-D0047-071",choosedist);
        if(choosecity=='Ëá∫ÂåóÂ∏Ç')loadWeather2("F-D0047-063",choosedist);
        if(choosecity=='Ê°ÉÂúíÂ∏Ç')loadWeather2("F-D0047-007",choosedist);
        if(choosecity=='Êñ∞Á´πÁ∏£')loadWeather2("F-D0047-011",choosedist);
        if(choosecity=='Êñ∞Á´πÂ∏Ç')loadWeather2("F-D0047-055",choosedist);
        if(choosecity=='ËãóÊ†óÁ∏£')loadWeather2("F-D0047-015",choosedist);
        if(choosecity=='Ëá∫‰∏≠Â∏Ç')loadWeather2("F-D0047-075",choosedist);
        if(choosecity=='ÂΩ∞ÂåñÁ∏£')loadWeather2("F-D0047-019",choosedist);
        if(choosecity=='ÂçóÊäïÁ∏£')loadWeather2("F-D0047-023",choosedist);
        if(choosecity=='Èõ≤ÊûóÁ∏£')loadWeather2("F-D0047-027",choosedist);
        if(choosecity=='ÂòâÁæ©Á∏£')loadWeather2("F-D0047-031",choosedist);
        if(choosecity=='ÂòâÁæ©Â∏Ç')loadWeather2("F-D0047-059",choosedist);
        if(choosecity=='Ëá∫ÂçóÂ∏Ç')loadWeather2("F-D0047-079",choosedist);
        if(choosecity=='È´òÈõÑÂ∏Ç')loadWeather2("F-D0047-067",choosedist);
        if(choosecity=='Â±èÊù±Á∏£')loadWeather2("F-D0047-035",choosedist);
        if(choosecity=='ÂÆúËò≠Á∏£')loadWeather2("F-D0047-003",choosedist);
        if(choosecity=='Ëä±ËìÆÁ∏£')loadWeather2("F-D0047-043",choosedist);
        if(choosecity=='Ëá∫Êù±Á∏£')loadWeather2("F-D0047-039",choosedist);
        if(choosecity=='ÊæéÊπñÁ∏£')loadWeather2("F-D0047-047",choosedist);
        if(choosecity=='ÈáëÈñÄÁ∏£')loadWeather2("F-D0047-087",choosedist);
        if(choosecity=='ÈÄ£Ê±üÁ∏£')loadWeather2("F-D0047-083",choosedist);
    })
})
function loadWeather2(citycode,distcode){
    let api_key = 'CWB-C96B02A5-E839-4870-B96E-B529AFC22581'
    let forecastURL = `https://opendata.cwb.gov.tw/fileapi/v1/opendataapi/`+citycode +`?Authorization=${api_key}&format=JSON` 
    console.log(forecastURL);
    $(document).ready(function(){
        $('.div').html("ËºâÂÖ•‰∏≠");
        $.ajax({
            url: forecastURL,
            type: "get",
            dataType:"json",
            success: function (info) {
                for(i=0;i<info.cwbopendata.dataset.locations.location.length;i++){
                    var temps=info.cwbopendata.dataset.locations.location[i];
                    if(temps.locationName==distcode){
                        $('.ctdiv').html(document.getElementById("city4").value+ " - " +document.getElementById("dist4").value);
                        for(j=0;j<15;j++){
                            if(j==7||j==8){
                                $('.ctdiv'+j).html("<b>" + temps.weatherElement[j].description+"Ôºö</b>"+temps.weatherElement[j].time[0].elementValue[0].value+" " +temps.weatherElement[j].time[0].elementValue[1].value);
                            }else if(j==11){
                                $('.ctdiv'+j).html("<b>" + temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue[0].value+" " +temps.weatherElement[j].time[0].elementValue[0].measures + "<b> " +
                                temps.weatherElement[j].time[0].elementValue[1].measures + "Ôºö</b>" + temps.weatherElement[j].time[0].elementValue[1].value );
                            }else if(j==12){
                                $('.ctdiv'+j).html("<b>"+temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue[0].value);
                            }else if(j==13){
                                $('.ctdiv'+j).html("<b>"+temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue[0].value + "Á¥ö <b>" + temps.weatherElement[j].time[0].elementValue[1].measures+"Ôºö</b>"+
                                temps.weatherElement[j].time[0].elementValue[1].value);
                            }else if(j==2){
                                $('.ctdiv'+j).html("<b>"+temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue.value + "%");
                            }else if(j==9){
                                $('.ctdiv'+j).html(`<font color="blue"><b>`+temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue.value + "%</font>");
                            }
                            else{
                                $('.ctdiv'+j).html("<b>"+temps.weatherElement[j].description+"</b>Ôºö"+temps.weatherElement[j].time[0].elementValue.value);
                            }
                        }
                        break;
                    }
                }
                console.log(info);
            },
            error: function (data) {
                console.log("Ë´ãÊ±ÇÂ§±Êïó");
            }
        });
    });
}
